<!doctype html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Garage Reset Password</title><script src="https://cdn.tailwindcss.com" id="tailwindCdn"></script><style>body{font-family:Montserrat,system-ui,-apple-system,sans-serif;background:radial-gradient(circle at top left,rgba(16,185,129,.08),transparent 40%),radial-gradient(circle at bottom right,rgba(59,130,246,.1),transparent 45%),#050505;color:#f4f4f5}</style></head><body class="min-h-screen flex items-center justify-center px-4"><div class="w-full max-w-md"><div class="text-center mb-6"><a href="/garage/" class="inline-block text-2xl uppercase tracking-[0.3em] text-zinc-100 mb-2 hover:text-zinc-200">Garage</a><div class="text-xs text-zinc-500 tracking-widest">Controller</div><div class="mt-1 text-[10px] text-zinc-500 tracking-widest">Reset Password</div></div><div class="rounded-2xl border border-zinc-800/70 bg-zinc-900/60 backdrop-blur-sm p-6"><div id="resetError" class="hidden mb-4 p-3 rounded-xl bg-red-500/10 border border-red-500/30 text-red-300 text-sm"></div><div id="resetNotice" class="hidden mb-4 p-3 rounded-xl bg-emerald-500/10 border border-emerald-500/30 text-emerald-200 text-sm"></div><a id="loginLink" href="/garage/" class="hidden mb-4 block w-full rounded-xl border border-zinc-700/60 bg-zinc-900/70 px-4 py-3 text-center text-xs uppercase tracking-widest text-zinc-300 transition hover:border-zinc-500 hover:text-zinc-100">Back to login</a><form id="resetForm" autocomplete="on"><div class="mb-5"><div class="text-[10px] uppercase tracking-widest text-zinc-500 mb-2">New password</div><input type="password" id="newPassword" autocomplete="new-password" class="w-full px-4 py-3 rounded-xl border border-zinc-700/50 bg-zinc-800/50 text-zinc-100 placeholder-zinc-500 focus:outline-none focus:border-emerald-500/50 transition-colors" placeholder="New password"/></div><div class="mb-6"><div class="text-[10px] uppercase tracking-widest text-zinc-500 mb-2">Confirm password</div><input type="password" id="confirmPassword" autocomplete="new-password" class="w-full px-4 py-3 rounded-xl border border-zinc-700/50 bg-zinc-800/50 text-zinc-100 placeholder-zinc-500 focus:outline-none focus:border-emerald-500/50 transition-colors" placeholder="Confirm password"/></div><button id="updateBtn" type="submit" class="w-full py-3 rounded-xl bg-emerald-500/20 border border-emerald-500/30 text-emerald-300 text-xs uppercase tracking-widest font-medium hover:bg-emerald-500/30 transition-colors">Update Password</button> <a id="backBtn" href="/garage/" class="mt-3 block w-full text-center text-[10px] uppercase tracking-widest text-zinc-400 transition hover:text-zinc-200">Back to login</a></form></div></div><script type="module">import{createClient as e}from"https://esm.sh/@supabase/supabase-js@2";const t="https://gtxrrrlopzzskyaumgly.supabase.co",n="sb_publishable_J2IkXRAJM_ENwBmhjHKzIw_9mYRoLHZ",o=e(t,n),a="garage_anon_id";let s=!1;const r=document.getElementById("resetForm"),i=document.getElementById("newPassword"),d=document.getElementById("confirmPassword"),c=document.getElementById("resetError"),l=document.getElementById("resetNotice"),u=document.getElementById("updateBtn"),h=document.getElementById("loginLink");function m(e){c.textContent=e,c.classList.remove("hidden")}r.addEventListener("submit",async function(e){e.preventDefault();const t=i.value,n=d.value;if(!t||!n)return void m("Please enter and confirm your new password.");if(t!==n)return void m("Passwords do not match.");c.classList.add("hidden"),l.classList.add("hidden"),u.textContent="Updating...",u.disabled=!0;const{error:a}=await o.auth.updateUser({password:t});var s;u.textContent="Update Password",u.disabled=!1,a?m(a.message):(s="Password reset. Redirecting to login...",l.textContent=s,l.classList.remove("hidden"),h.classList.remove("hidden"),i.value="",d.value="",setTimeout(()=>{window.location.href=h.href},2500))}),async function(){if(!s){s=!0;try{const e=function(){try{const e=localStorage.getItem(a);if(e)return e;const t=crypto.randomUUID();return localStorage.setItem(a,t),t}catch{return null}}();await fetch(`${t}/functions/v1/garage-page-view`,{method:"POST",headers:{apikey:n,"Content-Type":"application/json"},body:JSON.stringify({anon_id:e,path:location.pathname,referrer:document.referrer||"",title:document.title||"",screen:screen&&screen.width&&screen.height?`${screen.width}x${screen.height}`:"",viewport:`${window.innerWidth||0}x${window.innerHeight||0}`,device_type:/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent||"")?"mobile":"desktop",browser:"Unknown",os:"Unknown",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,locale:navigator.language||""})})}catch(e){console.warn("Failed to log page view:",e)}}}(),async function(){const e=new URLSearchParams(window.location.hash.replace(/^#/,"")),t=e.get("access_token"),n=e.get("refresh_token");if(t&&n){const{error:e}=await o.auth.setSession({access_token:t,refresh_token:n});return e?(m("Reset link expired. Please request a new one."),!1):(history.replaceState(null,"",window.location.pathname),!0)}const a=new URLSearchParams(window.location.search).get("code");if(a){const{error:e}=await o.auth.exchangeCodeForSession(a);return e?(m("Reset link expired. Please request a new one."),!1):(history.replaceState(null,"",window.location.pathname),!0)}const{data:s}=await o.auth.getSession();return Boolean(s&&s.session)}().then(e=>{e||m("Reset link expired. Please request a new one.")});</script></body></html>